(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{19:function(t,e,a){},25:function(t,e,a){t.exports=a(37)},30:function(t,e,a){},36:function(t,e,a){},37:function(t,e,a){"use strict";a.r(e);var n=a(0),c=a.n(n),o=a(21),r=a.n(o),i=(a(30),a(4)),s=a(11),l=a(6),u=a(7),m=a(9),h=a(8),d=a(10),p=(a(19),function(t){function e(t){var a;Object(l.a)(this,e),(a=Object(m.a)(this,Object(h.a)(e).call(this,t))).handleCheckUpdate=function(){fetch("/api?is_check=true").then(function(t){return t.json()}).then(function(t){localStorage.setItem("data",JSON.stringify(t)),a.setState({data:t})})};var n=[],c=localStorage.getItem("data");return c&&(n=JSON.parse(c)),a.state={data:n,test:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]},a}return Object(d.a)(e,t),Object(u.a)(e,[{key:"componentDidMount",value:function(){var t=this;this.state.data.length>0||fetch("/api").then(function(t){return t.json()}).then(function(e){if(console.log("response",e),e.has_error&&403===e.error_code){console.log("error",e.error_message);var a=e.data.remaining_seconds;t.props.history.replace("/remaining-time",{remainingSeconds:a})}else localStorage.setItem("data",JSON.stringify(e)),t.setState({data:e})})}},{key:"render",value:function(){return c.a.createElement("div",null,c.a.createElement("div",{style:{marginTop:16,textAlign:"center"}},c.a.createElement("button",{onClick:this.handleCheckUpdate},"\u68c0\u67e5\u66f4\u65b0"),c.a.createElement(i.b,{to:"/cast"},"Cast")),c.a.createElement("div",{className:"VideoList"},this.state.data.map(function(t,e){var a=t.uri,n=t.poster_uri,o=t.title,r=t.id,s=t.cast.map(function(t){return t.name}).join(",");return c.a.createElement("div",{key:e},c.a.createElement(i.b,{className:"VideoList__link",to:"/watch?v=".concat(a,"&id=").concat(r,"&cast=").concat(s)},c.a.createElement("img",{src:n,alt:o}),c.a.createElement("p",{className:"VideoList__title"},o)))})))}}]),e}(c.a.Component)),f=a(24),v=(a(36),function(t){function e(t){var a;Object(l.a)(this,e),(a=Object(m.a)(this,Object(h.a)(e).call(this,t))).handleDeleteButtonClicked=function(){if(window.confirm("Are you sure to delete this video?")){var t=new URLSearchParams(a.props.location.search).get("id");fetch("/api/videos/".concat(t),{method:"DELETE"}).then(function(){a.props.history.goBack()})}},a.handleShotButtonClicked=function(){fetch("/api/shots",{method:"POST"}).then(function(){a.props.history.goBack()})},a.handleAddCastButtonClick=function(){if(a.state.newCast){var t=new URLSearchParams(a.props.location.search).get("id"),e={cast_name:a.state.newCast};fetch("/api/videos/".concat(t),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(function(){a.setState({cast:a.state.cast.concat(a.state.newCast),newCast:""})})}},a.handleConfirmButtonClick=function(){if(a.state.start&&a.state.end){a.setState({status:"Loading..."});var t=new URLSearchParams(a.props.location.search).get("v"),e=t.split("."),n=Object(f.a)(e,2),c=n[0],o=n[1],r={input:t,output:"".concat(c,"_copy.").concat(o),start:a.state.start,end:a.state.end};fetch("/api/ffmpeg",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}).then(function(){console.log("done"),a.setState({status:"Done"})})}},console.log("dd",t.location.search);var n=new URLSearchParams(t.location.search);return a.state={cast:n.get("cast").split(","),newCast:"",start:"",end:"",status:""},a}return Object(d.a)(e,t),Object(u.a)(e,[{key:"render",value:function(){var t=this,e=new URLSearchParams(this.props.location.search);return c.a.createElement(c.a.Fragment,null,c.a.createElement("video",{controls:!0,autoPlay:!0},c.a.createElement("source",{src:e.get("v")})),c.a.createElement("button",{onClick:this.handleDeleteButtonClicked},"Delete"),c.a.createElement("button",{onClick:this.handleShotButtonClicked},"Shot"),c.a.createElement("div",null,this.state.cast.map(function(t,e){return c.a.createElement("span",{style:{marginRight:10},key:e},t)})),c.a.createElement("div",null,c.a.createElement("span",null,"New Cast:"),c.a.createElement("input",{type:"text",value:this.state.newCast,onChange:function(e){return t.setState({newCast:e.target.value})}}),c.a.createElement("button",{onClick:this.handleAddCastButtonClick},"Add Cast")),c.a.createElement("div",null,c.a.createElement("span",null,"Start:"),c.a.createElement("input",{type:"text",value:this.state.start,onChange:function(e){return t.setState({start:e.target.value})}}),c.a.createElement("span",null,"End:"),c.a.createElement("input",{type:"text",value:this.state.end,onChange:function(e){return t.setState({end:e.target.value})}}),c.a.createElement("button",{onClick:this.handleConfirmButtonClick},"Confirm"),c.a.createElement("span",null,this.state.status)))}}]),e}(c.a.Component)),g=a(14),E=function(t){function e(t){var a;Object(l.a)(this,e),a=Object(m.a)(this,Object(h.a)(e).call(this,t)),console.log("history state",t.location);var n=t.location.state.remainingSeconds;return a.state={remainingSeconds:n},a.secondsToString=a.secondsToString.bind(Object(g.a)(a)),a}return Object(d.a)(e,t),Object(u.a)(e,[{key:"componentDidMount",value:function(){var t=this,e=setInterval(function(){0===t.state.remainingSeconds?(clearInterval(e),t.props.history.replace("/")):t.setState({remainingSeconds:t.state.remainingSeconds-1})},1e3)}},{key:"secondsToString",value:function(t){return Math.floor(t/31536e3)+" years "+Math.floor(t%31536e3/86400)+" days "+Math.floor(t%31536e3%86400/3600)+" hours "+Math.floor(t%31536e3%86400%3600/60)+" minutes "+t%31536e3%86400%3600%60+" seconds"}},{key:"render",value:function(){return c.a.createElement("h1",{style:{color:"white"}},"Remaining time: ",this.secondsToString(this.state.remainingSeconds)," ")}}]),e}(c.a.Component),S=function(t){function e(t){var a;Object(l.a)(this,e),a=Object(m.a)(this,Object(h.a)(e).call(this,t));var n=[],c=localStorage.getItem("cast_data");return c&&(n=JSON.parse(c)),a.state={data:n},a}return Object(d.a)(e,t),Object(u.a)(e,[{key:"componentDidMount",value:function(){var t=this;this.state.data.length>0||fetch("/api/cast").then(function(t){return t.json()}).then(function(e){localStorage.setItem("cast_data",JSON.stringify(e)),t.setState({data:e})})}},{key:"render",value:function(){return c.a.createElement("div",null,this.state.data.map(function(t,e){var a=t.name,n=t.videos;return c.a.createElement("div",{key:e},c.a.createElement("div",{style:{color:"white"}},a),c.a.createElement("div",{className:"VideoList"},n.map(function(t,e){var a=t.uri,n=t.poster_uri,o=t.title,r=t.id,s=t.cast.map(function(t){return t.name}).join(",");return c.a.createElement("div",{key:e},c.a.createElement(i.b,{className:"VideoList__link",to:"/watch?v=".concat(a,"&id=").concat(r,"&cast=").concat(s)},c.a.createElement("img",{src:n,alt:o}),c.a.createElement("p",{className:"VideoList__title"},o)))})))}))}}]),e}(c.a.Component);function y(t){var e=t.match;return c.a.createElement("div",null,c.a.createElement("h2",null,"Topics"),c.a.createElement("ul",null,c.a.createElement("li",null,c.a.createElement(i.b,{to:"".concat(e.url,"/rendering")},"Rendering with React")),c.a.createElement("li",null,c.a.createElement(i.b,{to:"".concat(e.url,"/components")},"Components")),c.a.createElement("li",null,c.a.createElement(i.b,{to:"".concat(e.url,"/props-v-state")},"Props v. State"))),c.a.createElement(s.a,{path:"".concat(e.path,"/:topicId"),component:C}),c.a.createElement(s.a,{exact:!0,path:e.path,render:function(){return c.a.createElement("h3",null,"Please select a topic.")}}))}function C(t){var e=t.match;return c.a.createElement("div",null,c.a.createElement("h3",null,e.params.topicId))}var b=function(){return c.a.createElement(i.a,null,c.a.createElement("div",null,c.a.createElement(s.a,{exact:!0,path:"/",component:p}),c.a.createElement(s.a,{path:"/watch",component:v}),c.a.createElement(s.a,{path:"/topics",component:y}),c.a.createElement(s.a,{path:"/remaining-time",component:E}),c.a.createElement(s.a,{path:"/cast",component:S})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(b,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()}).catch(function(t){console.error(t.message)})}},[[25,1,2]]]);
//# sourceMappingURL=main.976bc9c1.chunk.js.map